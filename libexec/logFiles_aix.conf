$seekfilesdir = '/var/tmp' ;
# where the state information will be saved.

$protocolsdir = '/var/tmp';
# where protocols with found patterns will be stored.

$scriptpath = '/var/tmp';
# where scripts will be searched for.

$MACROS = {};

# Adjust logfile parameter for each hosts that who monitor
@searches = (
{
  tag => 'AIX errpt: tape',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  warningpatterns => [
    'TAPE_ERR1',
    'TAPE_ERR2',
    'TAPE_ERR3',
    'TAPE_ERR4',
    'TAPE_ERR5',
    'TAPE_ERR6',
    'SC_TAPE_ERR1',
    'SC_TAPE_ERR2',
    'SC_TAPE_ERR3',
    'SC_TAPE_ERR4',
    'SC_TAPE_ERR5',
    'SC_TAPE_ERR6',
    'SC_TAPE_ERR7',
    'SC_TAPE_ERR8',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: Cache battery',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATION',
  warningpatterns => [
    'FCP_ARRAY_ERR15',
    'DISK_ARRAY_ERR15',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: Loss redundancy power supply',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  warningpatterns =>  'EPOW_SUS',
},
{
  tag => 'AIX errpt: Microcode program error',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  warningpatterns => [
    'SCSI_ERR4',
    'CAT_ERR2',
    'SCSI_ERR3',
    'MID_UCODE',
    'FCS_ERR6',
    'FCS_ERR5',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: Stale partition',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  warningpatterns => 'LVM_SA_STALEPP',
},
{
  tag => 'AIX errpt: Adapter errors',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'SCSI_ERR1',
    'USB_ADAPTER_ERROR',
    'FCA_ERR1',
    'FCA_ERR9',
    'FCP_ERR1',
    'FCP_ERR5',
    'FCP_ERR9',
    'FSCSI_ERR4',
    'CAT_ERR8',
    'MID_PIPE2',
    'MID_BLASTB',
    'MPQP_XFTO',
    'ECH_ADAP_FAIL',
    'FCS_ERR2',
    'MID_PIPE1',
    'MID_PIPE3',
    'FCP_ERR6',
    'FCS_ERR1',
    'GOENT_EEPROM_ERR',
    'MPQP_ADPERR',
    'SCSI_ERR2',
    'GOENT_ADAP_ERR',
    'MID_PIPE4',
    'CAT_ERR5',
    'FCS_ERR9',
    'FCA_ERR2',
    'FSCSI_ERR2',
    'FSCSI_ERR1',
    'FCP_ERR2',
    'MID_BLAST',
    'FSCSI_ERR3',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: Array configuration changed',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'DISK_ARRAY_ERR10',
    'FCP_ARRAY_ERR10',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: Array configuration errors',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'SISIOA_ERR06T',
    'SISIOA_ERR04T',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: Array drive failure',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'FCP_ARRAY_ERR14',
    'DISK_ARRAY_ERR14',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: Array operation error',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'DISK_ARRAY_ERR1',
    'DISK_ARRAY_ERR2',
    'DISK_ARRAY_ERR3',
    'DISK_ARRAY_ERR4',
    'FCP_ARRAY_ERR1',
    'FCP_ARRAY_ERR2',
    'FCP_ARRAY_ERR4',
    'FCP_ARRAY_ERR3',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: Array controller switch failure',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'DISK_ARRAY_ERR9',
    'FCP_ARRAY_ERR9',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: Cache battery charge under 87%',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'FCP_ARRAY_ERR16',
    'DISK_ARRAY_ERR16',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: Controller health check failure',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [ 
    'DISK_ARRAY_ERR7',
    'FCP_ARRAY_ERR7',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: Controller death',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => 'TS_DEATH_TR',
},
{
  tag => 'AIX errpt: Cpu failure',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'CPU_FAIL_CAP_REDUCT',
    'CPU_FAIL_PREDICTED',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: Device errors',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'USB_DEVICE_ERROR',
    'GRAPHICS_ADAPTER_ER',
    'FCA_ERR14',
    'SISIOA_ERR01P',
    'FCP_ERR14',
    'SISIOA_ERR01T',
    'FCP_ERR13',
    'TMSCSI_RECVRD_ERR',
    'HARDWARE_SYMPTOM',
    'TMSCSI_CMD_ERR',
    'TMSCSI_UNRECVRD_ERR',
    'ATAIDE_ERR3',
    'FCA_ERR13',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: Disk operation failure',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'DISK_ERR1',
    'DISK_ERR2',
    'DISK_ERR3',
    'DISK_ERR4',
    'CMDLVM',
    'SC_DISK_ERR1',
    'SC_DISK_ERR2',
    'SC_DISK_ERR3',
    'SC_DISK_ERR4',
    'SC_DISK_ERR6',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: Ethernet Down',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'GOENT_FAILOVER_FAIL',
    'GOENT_LINK_DOWN',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: File System corruption',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'J2_BUFMGR_CORRUPT',
    'J2_SNAPSHOT_CORRUPT',
    'J2_IMFRLIST_CORRUPT',
    'J2_VCPAGER_CORRUPT',
    'J2_DTREE_CORRUPT',
    'J2_TXN_CORRUPT',
    'J2_METADATA_CORRUPT',
    'J2_IMAP_CORRUPT',
    'JFS_META_CORRUPTION',
    'J2_PAGER_CORRUPT',
    'J2_DMAP_CORRUPT',
    'J2_CORRUPTION',
    'J2_TXNLOCK_CORRUPT',
    'J2_LOG_CORRUPT',
    'J2_DIOBUF_CORRUPT',
    'J2_XTREE_CORRUPT',
    'JFS_META_WRITE_ERR',
    'J2_TXCMABRT_CORRUPT',
    'J2_DMAPI_CORRUPT',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: I/O errors',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'SM4_LOCK_DOWN',
    'J2_METADATA_EIO',
    'J2_LOG_EIO',
    'LVM_IO_FAIL',
    'J2_USERDATA_EIO',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: No paging space available',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => 'NO_PGSP',
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: PV declared Missing',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => 'LVM_SA_PVMISS',
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: PV defined as missing',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => 'LVM_MISSPVADDED',
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: SCSI Bus or Device errors',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'SISIOA_ERR01P',
    'SISIOA_ERR01T',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: Storage Subsystem failure',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'JFS_LOG_EXCEPTION',
    'JFS_META_EXCEPTION',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: Possible malfunction on local adapter',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => 'TS_LOC_DOWN_ST',
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: Unable to allocate space in Filesystem',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'JFS_FS_FULL',
    'JFS_FS_FRAGMENTED',
    'JFS_FS_NOINODES',
    'J2_FS_FULL',
  ],
  options => 'nologfilenocry',
},
{
  tag => 'AIX errpt: Unmanaged error',
  logfile => '/var/log/remote-hosts.log',
  rotation => 'LOGROTATE',
  criticalpatterns => '.*',
  options => 'nologfilenocry',
}
);
